# Getting Started

Welcome to Timeline - a framework-agnostic timeline infrastructure for video editing applications.

## Installation

### Core Package

Install the core timeline engine:

```bash
npm install @timeline/core
```

### React Adapter

For React applications, also install the React adapter:

```bash
npm install @timeline/react
```

## Quick Start

### Using the Core Engine

```typescript
import {
  TimelineEngine,
  createTimeline,
  createTimelineState,
  createTrack,
  createClip,
  createAsset,
  frame,
  frameRate,
} from "@timeline/core";

// Create a timeline
const timeline = createTimeline({
  id: "timeline_1",
  name: "My Timeline",
  fps: frameRate(30),
  duration: frame(9000), // 300 seconds @ 30fps
  tracks: [],
});

// Create the engine
const engine = new TimelineEngine(createTimelineState({ timeline }));

// Add a track
const track = createTrack({
  id: "track_1",
  name: "Video Track 1",
  type: "video",
});
engine.addTrack(track);

// Register an asset
const asset = createAsset({
  id: "asset_1",
  type: "video",
  duration: frame(300),
  sourceUrl: "video.mp4",
});
engine.registerAsset(asset);

// Add a clip
const clip = createClip({
  id: "clip_1",
  assetId: asset.id,
  trackId: track.id,
  timelineStart: frame(0),
  timelineEnd: frame(100),
  mediaIn: frame(0),
  mediaOut: frame(100),
});
engine.addClip(track.id, clip);

// Get current state
const state = engine.getState();
console.log(state.timeline);
```

### Using with React

```typescript
import { TimelineEngine, createTimeline, createTimelineState } from '@timeline/core';
import { TimelineProvider, useTimeline } from '@timeline/react';

// Create engine instance
const engine = new TimelineEngine(
  createTimelineState({
    timeline: createTimeline({
      id: 'timeline_1',
      name: 'My Timeline',
      fps: frameRate(30),
      duration: frame(9000),
      tracks: [],
    }),
  })
);

// Wrap your app with the provider
function App() {
  return (
    <TimelineProvider engine={engine}>
      <TimelineEditor />
    </TimelineProvider>
  );
}

// Use hooks in components
function TimelineEditor() {
  const { state, engine } = useTimeline();

  return (
    <div>
      <h1>{state.timeline.name}</h1>
      <p>Tracks: {state.timeline.tracks.length}</p>

      <button onClick={() => {
        const track = createTrack({
          id: generateTrackId(),
          name: 'New Track',
          type: 'video',
        });
        engine.addTrack(track);
      }}>
        Add Track
      </button>
    </div>
  );
}
```

## React Hooks

The `@timeline/react` package provides several hooks:

### `useTimeline()`

Subscribe to the entire timeline state:

```typescript
const { state, engine } = useTimeline();
```

### `useTrack(trackId)`

Subscribe to a specific track:

```typescript
const track = useTrack("track_1");
```

### `useClip(clipId)`

Subscribe to a specific clip:

```typescript
const clip = useClip("clip_1");
```

### `useEngine()`

Access the engine instance:

```typescript
const engine = useEngine();
```

## Next Steps

- Learn about the [Architecture](/docs/architecture)
- Explore the demo application
- Check out the API reference

## Key Concepts

### Frame-Based Time

Timeline uses frame numbers instead of milliseconds for deterministic, reproducible behavior:

```typescript
const fps = frameRate(30);
const oneSecond = frame(30); // 30 frames @ 30fps = 1 second
```

### Deterministic State

All operations are deterministic and reproducible. The same sequence of operations always produces the same result.

### Subscription Model

The engine notifies subscribers when state changes, enabling automatic UI updates:

```typescript
const unsubscribe = engine.subscribe(() => {
  const newState = engine.getState();
  // Update UI
});

// Clean up
unsubscribe();
```

### Undo/Redo

Built-in history system for undo/redo:

```typescript
engine.undo();
engine.redo();
engine.canUndo(); // boolean
engine.canRedo(); // boolean
```
